# Шаг 3 (Unit_03). Обзор основ deep learning.  
Рекомендательная система постов для конкретного пользователя с определённым id. В отличие от unit_02 в этом блоке, в качестве признаков постов, использовались их эмбеддинги, полученные нейронной сетью. Для рекомендации использовались алгоритмы классического машинного обучения. Система также аналогично unit_02 выполнена ввиде web-сервиса и содержит один endpoint:  
* `@app.get("/post/recommendations/", response_model=List[PostGet])`  
`def recommended_posts(id: int, time: datetime, limit: int = 10) -> List[PostGet]:`  
Возвращает для пользователя с id, для даты-времени time, limit рекомендованных постов.  
Пример запроса:  
`http://имя_сервера/post/recommendations/?id=200&time=2020-10-20T14:00&limit=5`  

### Описание файлов.  
* ___app_unit_03_github.py___  
Исходный код веб-сервиса.
* ___schema.py___  
Описание таблиц БД через библиотеку pydantic, для задания и проверки формата ответа endpoint веб-сервиса.
* ___catboost_model_6_unit_03_github___  
Обученная модель CatBoostClassifier, которая предсказывает вероятность лайка поста пользователем.  
* ___karpov-final-unit-03-table-post-emb.ipynb___  
Ноутбук в котором осуществлялся подсчёт эмбеддингов постов через нейронную сеть архитектуры трансформер и их дальнейшая запись в таблицу БД.
* ___karpov-final-unit-03-table-post-emb.ipynb___  
В этом ноутбуке на основе эмбеддингов постов вычислялись новые признаки. На основе новых признаков постов и признаков пользователей из unit_02 обучалась модель и подбирались параметры модели для получения максимального значения метрики качества на тестовой выборке.  

#### Итоговый hitrate, разработанного алгоритма, в чекере учебной системы LMS, составляет 0.571.  
